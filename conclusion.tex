\chapter{Conclusion}
\label{ch:conclusion}

Trapping ultracold atoms and molecules in optical lattices has opened an exciting frontier of condensed 
matter research\cite{Baranov2012}. In the limit of strong trapping fields that completely suppress particle tunneling
in optical lattices, an artificial crystal of atoms and molecules, called the Mott insulator phase, appears. These artificial crystals possess 
unique properties -- in particular, they offer  the ability to address single lattice sites\cite{atom-mott1, atom-mott2} and the possibility for controlling interparticle interactions with external electric or magnetic fields\cite{quemener2012, Baranov2012},  making them a very good platform to
study collective phenomena\cite{our-njp-review, quemener2012, Baranov2012}. The thesis, by utilizing  the controllability of the artificial crystals of ultracold particles, explores theoretically the mechanisms for  
controlling the quantum dynamics
of quasiparticles.  

\section{Summary of the thesis}

The control schemes presented in this thesis can be categorized into two major types: 1) mixing internal states by external fields; 2) changing the phase of internal states by temporal perturbations. 

The first type
of control schemes is commonly used to control the interparticle interactions in the field of ultracold atoms and molecules. 
For example, it has been shown that both the shape and strength of the dipole-dipole interaction between molecules
can be controlled by external fields\cite{micheli2007}, which inspires numerous study on using molecules trapped on optical
lattices for quantum simulation\cite{Barnett2006, micheli2006, Brennen2007, Buchler2007, Carr, Carr2, Trefzger2010, Kestner2011, gorshkov, gorshkov2}. Instead, the current thesis studied the possibility of using the external fields to control
inter-quasiparticle interactions rather than interparticle interactions.  In the case of the rotational excitation of polar molecules 
trapped in an optical lattice, the dipole-dipole operator leads to 
different kinds of inter-quasiparticle interactions, namely the hopping interaction that is responsible for excitation 
propagation, the attractive dynamic interaction that can induce exciton binding, and the conversion interaction that can split
a high-energy exciton into two low-energy excitons. These interactions are associated with different dressed rotational states of molecules, which correspond to different mixing of bare rotational states in external fields.  So the different inter-quasiparticle
interactions respond differently to the change of external fields. 
This thesis showed that the ratio between the hopping and the 
dynamic interaction can be tuned by an electric field to induce the formation of biexciton and triexciton states with tunable 
binding energies, and found that the conversion interaction leads to an non-optical way to create biexciton states from the high-energy ($N=2$)
excitonic states under the resonance condition when a high-energy
excitonic state have the same energy as two low-energy ($N=1$) excitonic states. These results demonstrated that the 
physics of dipole-dipole interactions in the context of quasiparticles is also rich and opened up the possibility to control the 
binding and creation of collective excitation modes of polar molecules trapped on optical lattices. 

The second type of control schemes is reminiscent of the techniques used for strong-field alignment and orientation of 
molecules in the gas phase\cite{alignment-review}. The essential idea is to use an external field to perturb the internal states
of molecules for a short time, adding phases to the wavefunctions of the internal states. This perturbation does not change
the interparticle interactions as the internal states remain the same except that their phases are changed. Though the phase
changes are seemingly unimportant, they play an important role in determining the dynamics of quasiparticles. Since a collective excitation in an array of coupled monomers is a superposition of internal states of monomers, any phase change
of the internal states will translate to a change of quasimomentum of  the collective excitation, and influence the excitation
energy propagation in the array. The thesis showed that specific phase transformations can be used to accelerate or 
decelerate excitation energy transfer and spatially focus delocalized excitations in arrays of quantum particles.  The 
proposed control scheme is very general as the excitations can be of any type and the array can be ordered and 
disordered. This thesis also demonstrated the feasibility of the control scheme in the system of ultracold atoms and 
molecules trapped on optical lattices. All the above results showed that the phases of individual monomer state in an array of coupled monomers can be used to manipulate the quantum energy transfer in the array, which 
pointed out a new way to control the dynamics of quasiparticles.  


In addition, the thesis extended calculations of lattice Green's functions to disordered systems. The proposed method
is  numerically more efficient than conventional methods and may be used to study the dynamics of quasiparticles in 
strongly disordered potentials. 

\section{Limitations and possible extension}
%%
In this section, I discuss the limitations of the thesis and explain how the current work can be extended by going beyond those limitations. 

Conventionally, the 1D and 2D crystals of ultracold atoms and molecules are created in 3D optical lattices. In a 3D 
optical lattice, since the intensity of every laser pair can be tuned independently, the trap depths along the $x$,
$y$ and $z$ directions can be adjusted separately. By making the trap depths along the $x$ and $y$ directions so deep
that the particle tunneling along these two directions are completely suppressed, an effective 1D crystal can be constructed
in which the trapped particles are only allowed to move in the periodic potentials along the $z$ direction. Similarly, an effective 2D crystal
can be created by suppressing the motion of trapped particles along just one direction. 
%In these crystals, it is the trapped atoms or molecules that are moving.
 In  this thesis, I study the excitations, rather than real particles,  trapped in one and two dimensions. 
To confine excitations in reduced dimensionalities, it is not enough to use the effective 1D and 2D systems described 
previously since excitations can still leak into other dimensions even if the tunneling of real particles along that direction is 
completely suppressed. 
Theoretically, one needs a truely 1D or 2D crystal in a 3D optical lattice, where only the sites along a single line 
or on a single plane are occupied by atoms or molecules. 
%The problem is that such an 1D or 2D crystal is  difficult to obtain in experiments as it requires high precision to remove particles from the lattice sites that don't belong to the
%required arrays.
 In practice, one may use a 3D optical lattice with one polar molecule per site in the Mott insulator 
phase. To approximate the 1D and 2D crystals required in the thesis, the wavelengths of laser beams in some directions 
can be increased, producing larger lattice separations along those directions and reducing the strength of coupling between 
molecules in the corresponding dimensions. This leads to suppression of the excitation propagation along those directions,
creating the quasi-1D and quasi-2D arrays. 
% with the required 1D and 2D arrays along the dimensions with the smaller lattice separations.  
However, limited by the available wavelengths of the laser beams used to form optical lattices, the ratio between the large 
and small lattice separations along different directions is typically about 2$\sim$3. This means that the interaction 
between nearest neighbors along the direction with the large lattice constant will be of the same magnitude as the 
interaction between next nearest neighbors or next next nearest neighbors along the direction with small lattice constant.
As shown in \autoref{ch:energy-transfer}, the long-range interaction between molecules can play a role in determining
the dynamics of quasiparticles, therefore it may be necessary to include the weak interactions along the suppressed dimension(s). 
In addition, because the dipole-dipole interaction is anisotropic and the relative orientations of the dipole moments with respect to the intermolecular axis are different, the weak interactions along the suppressed dimension(s) generally have different signs from the strong interaction within the 1D and 2D arrays. So it would be interesting to investigate whether the results obtained for purely 1D and 2D arrays are valid for the quasi-1D and quasi-2D crystals and especially the effect of 
the anisotropic weak interactions. 


 In the thesis, 
I have assumed that the optical lattices are deep and ignored the translational motion of molecules within the trap. 
Going beyond this assumption may lead to interesting results. 
Recently, Herrera and Krems showed that the rotational excitons can interact with the translational motion of molecules to
form polarons\cite{felipe-polarons}. The Hamiltonian for these polarons includes a combination of  breathing-mode and 
Su Schrieffer-Heeger couplings, leading to interesting sharp transitions in the polaron phase diagram\cite{felipe-arxive-polaron}. It might be possible to extend Herrera's work to include the dynamic interaction between excitons. 
%In the usual case, the lattice deformation associated with polaron may lead to an effective attraction 
%between polarons, producing bipolarons\cite{alexandrov1995} which are bound states of two polarons. 
% In the current artificial crystals of polar 
%molecules, the exciton-exciton dynamic interaction induces an extra interaction between polaron, it would be interesting to
%explore whether this leads to the formation of bipolarons. 
%If this new type of bipolarons exist, their propagation behavior 
%might be different from that of the conventional bipolarons induced by lattice deformation.
% In fact,
%going beyond this assumption may lead to interesting results related to high-temperature superconductivity. 
%As Ref. \cite{felipe-polarons} shows, the rotational excitons can interact with the translational motion of molecules to
%form polarons. 
%Understanding the mechanism for high-temperature superconductivity is a great theoretical challenge in condensed 
%matter physics\cite{alexandrov2003}.
%Since bipolarons has been suggested as a possible mechanism for high temperature 
%superconductivity\cite{alexandrov2003}, 
% it would be very interesting to explore whether the attractive dynamic interaction between excitons leads to the
%formation of bipolarons in the current artificial crystals of polar molecules. Though the bipolarons will be different 
%from those in high-temperature superconductors, studying the properties of the bipolarons in our system, especially 
%its propagation behavior, may shed some light on the theory of high-temperature superconductivity.  

% Future work might 
%consider the scenario of Frenkel excitons coupled with lattice phonons in shallow optical lattices to form so-called polarons. It would be very interesting to explore whether the attractive dynamic interaction 
%between excitons leads to the formation of bipolarons. 


% In \autoref{ch:biexciton}, we only considered  simple 
%$^{1}\Sigma$ molecules. In the future, it might be interesting to consider more complicated molecules that can interact 
%with more types of external fields. For example, an ensemble of $^{2}\Sigma$ molecules in the ro-vibrational
%ground state trapped on an optical lattice has been shown to exhibit collective spin excitations. It would be interesting to 
%see whether the spin exciton-exciton interaction in such a system can be controlled with both electric and magnetic fields and if there exist
%bound states of the spin excitons. 


\autoref{ch:biexciton} has shown the existence of  the two-body and three-body bound states of excitons under certain 
conditions. However, this does not mean that biexciton and triexciton states will appear at any exciton concentrations. 
In the presence of multiple excitons, the combination of a biexciton and an exciton might be unstable to triexciton formation
 and triexciton $+$ exciton might be unstable to bigger bound complexes.  So it is necessary to extend our theoretical
model to handle $n$-body bound states and to investigate the fundamental limits of exciton clustering. References 
\cite{Ezaki1994, orchinnikov1967, pleutin2000} have already studied the problem of exciton clustering under the 
nearest-neighbor approximation and implied the existence of  excitonic $n$-string where $n$ can be any 
positive integer.  It might be 
interesting to extend their analysis to the case of long-range interactions. 


The work on energy transfer presented in the thesis has so far ignored the interactions between excitons. This is justified for the case of the rotational 
excitations in small external fields as the exciton--exciton interaction is small compared with the hopping interaction. 
However as \autoref{ch:biexciton} shows, the dynamic interaction between excitons can be comparable and even a few 
times larger than the hopping interaction at certain electric field strengths. In this situation, it is important to investigate
 if the control scheme works in the presence of exciton-exciton interactions. Particularly, it would be very interesting to see whether we can control the propagation
 of the biexciton states. 
 
 
%The scheme  to various types of quasiparticles. For 
%example, the biexciton state found in \autoref{ch:biexciton} is a very promising candidate. As the biexciton state is a 
%bound state due to the dynamic interaction, it would be very interesting to see how the exciton-exciton interaction will 
%influence the control of energy transfer. 

% Up to this point, we have only considered the feasibility of the control scheme in the system of ensembles of ultracold
% atoms and molecules trapped on optical lattices. It might be also worthwhile to consider other types of systems. For 
% example, an ensemble of molecules can be trapped in rare gas matrices or in solid hydrogen matrices and form a disordered array with the lattice separation of only a few nm. It would be interesting to see whether our control scheme
% can work in the arrays with such a small lattice constant. 

%The method to calculate Green's functions, as presented in \autoref{ch:greenfunc}, is very generic. Future research might
%use it to study all sorts of many-body physics in the presence of strong disorders. For example, it is possible to
%use the method to calculate the local density of states in a  high-dimensional disordered lattice, which might yield useful information about the 
%existence of bound states of quasiparticles in the presence of strong disorders. 


\section{Future research directions}

\subsection{Influence of exciton-exciton interaction on polariton lasing}
% what is polariton
The coupling between cavity photons and excitons gives rise to the half-light and half-matter quasiparticles called 
cavity polaritons\cite{kavokin2007}. Unlike the weakly interacting cavity photons, polaritons can strongly interact with each 
other due to the inherited strong-interacting characteristics from the matter (or exciton) components. This polariton-polariton
interaction produces effective strong photon-photon interaction, and leads to the emerging field of quantum fluids of
 light\cite{carusotto2013}. One branch of the field focuses on using the  Bose-Einstein condensate of cavity polaritons to create
 polariton laser, a new coherent source of light that may lead to new optoelectronic devices\cite{pavlos2014}. 
 Polaritons decay in a cavity because their photonic components leak out through 
 cavity mirrors. When polaritons form a condensate, the decay of polaritons in the  macroscopic coherent state produces
 photons in the same coherent state. This process is similar to the conventional photon lasing except the population
 inversion, therefore polariton lasing has a much lower threshold energy for coherent emission\cite{daskalakis2003}. 
 %There has been greate success in the development of the
 %polaritons lasers and the most notable are the room-temperature polariton lasing\cite{plumhof2014, daskalakis2014, 
 %bhattacharya2014}. 

In experiments with polariton lasers, both inorganic and organic semiconductors can be used as a basis for 
microcavities\cite{pavlos2014}. However, they have very different excitonic modes. In inorganic semiconductors, the 
excitons are  loosely-bound electron-hole pairs called Wannier-Mott excitons, while in organic materials, the excitons are 
tightly-bound electron-hole pairs called Frenkel excitons. Compared with Wannier-Mott excitons, Frenkel excitons are highly
stable at room temperature\cite{lidzey395}. As a result, there is a trend towards using organic materials as the 
microcavities\cite{pavlos2014}, with the notable achievement of room-temperature polariton lasing\cite{plumhof2014, 
daskalakis2014}.

Polariton lasers requires the Bose-Einstein condensate of polaritons. To form a polariton condensate,  efficient 
relaxation mechanisms are required to transfer populations from other polariton states to the ground polariton state.  
The polariton-polariton scattering\cite{ciuti1998, tassone1999}, usually resulting from both the Coulomb interaction between 
excitons and the exciton saturation,  is a very important relaxation mechanism. In organic materials, due to the strong 
screening effect, the Coulomb interaction is very weak. So the exciton saturation or the kinematic interaction (see \autoref{ch:biexciton}), originating from the fact that two excitons
cannot sit on the same lattice site, plays the dominant role and it is well investigated\cite{zoubiKinematic, litinskaya2008, 
bittner2012}. 
%and it is the same as the kinematic interaction discussed in \autoref{ch:biexciton}. 
To the contrary, another type of exciton-exciton interaction, namely the dynamic interaction (see \autoref{ch:biexciton}), is not discussed with regard to polariton lasers in organic semiconductors. In an organic crystal, if the molecules possess static dipole 
moments, the dynamic interaction can be as large as the width of the exciton bandwidth\cite{agranovich}. This strong 
 dynamic exciton interaction can have a significant effect on the polariton-polariton interaction. It would be very interesting
 to investigate whether the dynamic interaction can enhance the relaxation towards the ground polariton
 state and further reduce the threshold energy for polariton lasing. 
 
To simulate the polaritons in organic semiconductors, one could use a dipolar crystal of ultracold polar molecules 
 trapped on the surface of a high-Q superconducting stripline cavity, like the setup described in 
Ref.~\cite{peter-rabl} and Ref.~\cite{peter-rabl2}.
The rotational excitons of the molecular array resemble the Frenkel electronic excitons in the 
 organic crystal. The cavity photons can be provided by a microwave stripline cavity. 
The rotational excitons may couple strongly with the microwave photons to form polaritons. 
(Note that the conventional 
microwave cavities like those in Ref. \cite{raimond2001} cannot be used here because their large size results in very 
weak interaction between excitons and photons.) 
In the current system,  an external dc field is required to induce electric dipole moments of polar molecules to 
maintain the dipolar crystal. This external field can be tuned to change the strength
of exciton-exciton interaction. Because of this tunability, it would be very interesting to study the condition of 
polariton lasing in the current system and to investigate the influence of exciton-exciton interaction 
 on polariton relaxation. 
Recently, Cristofolini \textit{et al}. have demonstrated polaritons with static dipole moments\cite{cristofolini2012}. 
It is expected that the static dipole moments will reinforce polariton-polariton interactions, just like the dynamic 
interaction discussed before, and may lead to new effects as discussed in Ref.\cite{astrakharchik2007} and 
Ref.\cite{boning2011}.  The current system may also be used as a platform to study new polariton physics of
the long-range dipolar interactions. 
  
% why Frenkel polariton in organic semiconductors

%\subsection{Anderson localization in the long-range dipolar interaction}

\subsection{Parallel computation of Green's functions}

With the advance of technology, multi-core processors are becoming more powerful and less expensive, and they are 
expected 
to become the mainstream for large scientific computations. Calculating the Green's functions for multiple particles is 
always a computation intensive task due to the large number of degrees of freedom involved, so it is desirable to 
develop parallel numerical methods to speed up the computation. 
%numerical methods to fully harness the multi-core architecture of the hardware. 
However, the recursive method to calculate the Green's 
functions, as presented in \autoref{ch:greenfunc}, can only be implemented in a sequential way.  This can be easily 
seen from \autoref{eqn:recursionForTildeA} and \autoref{eqn:recursionForA}: the calculation of  
$\mathbf{\Tilde{A}}_{n} (\mathbf{A}_n)$ can only be done after $\mathbf{\Tilde{A}}_{n} (\mathbf{A}_{n+1})$ is 
calculated.  In the following, I sketch a parallel way to calculate the Green's function as a future research 
direction. This method is inspired by the recursive doubling algorithm for solving the tridiagonal 
systems\cite{egecioglu1989}. 

For simplicity, I only discuss the case with the nearest-neighbor coupling. It is straightforward to extend the discussion to
cases with long-range interactions. Based on the analysis in \autoref{ch:greenfunc}, the equation of motion for the Green's
function can be rewritten as a set of recursive relations:
\oneline{
\mathbf{W}_{K}\mathbf{V}_{K} = \boldsymbol\alpha_{K}\mathbf{V}_{K-1} + \boldsymbol\beta_{K}\mathbf{V}_{K+1} + \boldsymbol\gamma_{K}
}
where $\boldsymbol\gamma_{K}$ can be a zero vector or nonzero vector. For a finite crystal, the value of $K$ is from 
$1$ to  $K_{\rm max}$. Rewriting the above recursion relation as
\oneline{
\mathbf{V}_{K+1} = \boldsymbol\beta_{K}^{-1}\mathbf{W}_{K}\mathbf{V}_{K} -  \boldsymbol\beta_{K}^{-1}\boldsymbol\alpha_{K}\mathbf{V}_{K-1} -  \boldsymbol\beta_{K}^{-1}\boldsymbol\gamma_{K} \ ,
}
one can easily derive the following equation:
\multiline{
\colvec{3}{\mathbf{V}_{K+1}}{\mathbf{V}_{K}}{\mathbf{1}}
=
\mat{
\boldsymbol\beta_{K}^{-1}\mathbf{W}_{K}&  -\boldsymbol\beta_{K}^{-1}\boldsymbol\alpha_{K}&
-\boldsymbol\beta_{K}^{-1}\boldsymbol\gamma_{K} \\
\mathbf{1} & \mathbf{0}& \mathbf{0} \\
\mathbf{0} & \mathbf{0}& \mathbf{1}
 }
\colvec{3}{\mathbf{V}_{K}}{\mathbf{V}_{K-1}}{\mathbf{1}} \ .
}
If we define
\oneline{
\mathbf{X}_{K} \equiv \colvec{3}{\mathbf{V}_{K}}{\mathbf{V}_{K-1}}{\mathbf{1}} 
}
and 
\oneline{
\mathbf{B}_{K} \equiv 
\mat{
\boldsymbol\beta_{K}^{-1}\mathbf{W}_{K}&  -\boldsymbol\beta_{K}^{-1}\boldsymbol\alpha_{K}&
-\boldsymbol\beta_{K}^{-1}\boldsymbol\gamma_{K} \\
\mathbf{1} & \mathbf{0}& \mathbf{0} \\
\mathbf{0} & \mathbf{0}& \mathbf{1}
 } \ ,
}
we have 
\oneline{
\mathbf{X}_{K+1} = \mathbf{B}_{K} \mathbf{X}_{K} \;\;\;\;\mbox{for $1\leq K \leq K_{\rm max}$} \ . \label{eqn:newRecursion}
}
So once $\mathbf{X}_1$ is known, all other $\mathbf{X}_K$ can be calculated by repeated application of 
\autoref{eqn:newRecursion}:
\multiline{
\mathbf{X}_{2} &=& \mathbf{B}_{1} \mathbf{X}_{1} \nonumber \\
\mathbf{X}_{3} &=& \mathbf{B}_{2} \mathbf{X}_{2} =  \mathbf{B}_{2} \mathbf{B}_{1} \mathbf{X}_{1} \nonumber \\
& \cdots& \nonumber \\
\mathbf{X}_{K_{\rm max}+1} &=& \mathbf{B}_{K_{\rm max}}  \mathbf{B}_{K_{\rm max}-1}\cdots \mathbf{B}_{2} \mathbf{B}_{1} \mathbf{X}_{1} \ . \label{eqn:calculateAllV}
}
To simplify the notation, we can define the products of the $\mathbf{B}$ matrices as
\oneline{
\mathbf{C}_{K} =  \mathbf{B}_{K}  \mathbf{B}_{K-1}\cdots \mathbf{B}_{2} \mathbf{B}_{1} \mathbf{X}_{1}  \;\;\;\;\mbox{for $1\leq K \leq K_{\rm max}$} \ ,
}
which allows us to write
\oneline{
\mathbf{X}_{K_{\rm max}+1} = \mathbf{C}_{K_{\rm max}} \mathbf{X}_1 \ . \label{eqn:lastRecursion}
}
It can be easily shown that all the $\mathbf{C}_{K}$ matrices have the following pattern:
\oneline{
\mathbf{C}_{K} = \mat{
\mathbf{g}^{K}_{11}&  \mathbf{g}^{K}_{12}& \mathbf{g}^{K}_{13} \\
\mathbf{g}^{K}_{21}&  \mathbf{g}^{K}_{22}& \mathbf{g}^{K}_{23} \\
\mathbf{0} & \mathbf{0}& \mathbf{1}
 } 
}
where the $\mathbf{g}$ blocks can take zero or nonzero values. Therefore \autoref{eqn:lastRecursion} becomes
\multiline{
\colvec{3}{\mathbf{V}_{K_{\rm max}+1}}{\mathbf{V}_{K_{\rm max}}}{\mathbf{1}}
= \mathbf{C}_{K_{\rm max}}\colvec{3}{\mathbf{V}_{1}}{\mathbf{V}_{0}}{\mathbf{1}}
=
\mat{
\mathbf{g}_{11}&  \mathbf{g}_{12}& \mathbf{g}_{13} \\
\mathbf{g}_{21}&  \mathbf{g}_{22}& \mathbf{g}_{23} \\
\mathbf{0} & \mathbf{0}& \mathbf{1}
 } 
\colvec{3}{\mathbf{V}_{1}}{\mathbf{V}_{0}}{\mathbf{1}} \ . \label{eqn:lastRecursion2}
}
By definition, $\mathbf{V}_{K_{\rm max}+1} = \mathbf{0}$ and $\mathbf{V}_{0} = \mathbf{0}$, then from 
\autoref{eqn:lastRecursion2}, we obtain
\oneline{
\mathbf{0} = \mathbf{g}_{11} \times \mathbf{V}_{1} +  \mathbf{g}_{13} \times \mathbf{1} \ ,
}
from which $\mathbf{V}_{1}$ can be obtained. After that, all other $\mathbf{V}_K$ can be calculated from \autoref{eqn:calculateAllV}. 

The most time-consuming part of the above method is to calculate the products of the $\mathbf{B}$ 
matrices: $\mathbf{C}_1$, $\mathbf{C}_2$, $\cdots$, $\mathbf{C}_{K_{\rm max}}$. If one can make this computation
parallel, the above algorithm can be accelerated. It turns out that the computation of the series of $\mathbf{C}_K$ 
matrices is very similar to the all-prefix-sums operation in parallel algorithms\cite{BlellochTR90}. Given an array of objects
\oneline{[a_1, a_2, \cdots, a_n] \nonumber }
and a binary associative operator $\oplus$, the all-prefix-sums operation returns the ordered set
\oneline{
\left[ a_1, \left(a_1 \oplus a_2\right), \cdots, \left(a_1 \oplus a_2\oplus\cdots\oplus a_n\right) \right] \nonumber \ .
}
As one of the simplest and most useful building blocks in parallel algorithms\cite{BlellochTR90}, the all-prefix-sums 
operation is well studied and has been implemented in various ways\cite{gpu-book}. However, many existing 
algorithms implicitly assume the computation cost of the binary operation $\oplus$ between any two consecutive 
objects $a_i$ and $a_{i+1}$ to be almost the same. This is not the case here because the dimension of the $\mathbf{B}_{K}$ can
vary a lot depending on the value of $K$. For example,  $\mathbf{B}_{K}$ has the largest size when $K\approx K_{\rm max}/2$. 
Therefore the existing algorithms might not be optimal for our case and we may need to implement an all-prefix-sums 
operation that is specially tailored for the current 
situation. 















 