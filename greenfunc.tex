%chapter on Green's function
\chapter{Lattice Green's function of two-particle state}
\label{ch:greenfunc}

\section{Introduction}
\label{sec:introGreenFunc}

Green's function is an important theoretical tool in the study of condensed matter systems. Its applications range from

The numerical evaluation of the Green's function is a cumbersome task.

In this chapter, we extend the numerical method \cite{Berciu2010, Berciu2011, Berciu2012} developed by Berciu to a system with arbitary disorders. Then we employ the Green's function to study the tunneling of biexciton states through
a disorder. 

\section{Equation of motion for Green's function}
\label{sec:equationOfMotion}

To derive the equation of motion for Green's function, we start from the Hamiltonian for the system. We are 
considering a 1D periodic lattice with the Hamiltonian:
\multiline{
\hat{H} = \sum_{l} e_{l} \pd{l}\p{l} + \sum_{l}\sum_{r\neq 0} t_{l, l+r} \pd{l}\p{l+r} + \sum_{l}\sum_{r\neq 0} d_{l, l+r} \pd{l}\pd{l+r}\p{l}\p{l+r} \ , \label{eqn:initialHam}
}
where $e_l$ is the energy of the particle at site $l$, $\pd{l}$ create a particle at site $l$, $t_{l, l+r}$ represents the hopping interaction between
site $l$ and site $l+r$, and $d_{l, l+r}$ represents the dynamic interaction between
site $l$ and site $l+r$. Note that the Hamiltonian $\hat{H}$ is very general as there is no restriction on the values 
of $e_l$, $t_{l, l+r}$, and $d_{l, l+r}$, and thus it can describe both an ordered system and an 
disordered system. The Green's operator is defined in terms of the Hamiltonian,
\oneline{
\hat{G}(z) \equiv (z - \hat{H})^{-1} \ ,
}
where $z = E + i\eta$ is the complex energy. From the definition of the Green's operator, it is clear that  
\oneline{
(z - \hat{H}) \hat{G}(z) = 1 \ . \label{eqn:equationForG}
}
The above equation contains all information about the system. 

Depending on the system in consideration, the creation and anhilation opreators will satisfy different commutation
rules. For instance, if the particles are femions, $\pd{n}$ and $\p{m}$ satisfy the anticommutation relations:
\multiline{
&&\{\pd{n}, \p{m}\} = \pd{n}\p{m} + \p{m}\pd{n} = \delta_{n, m} \ , \nonumber \\
&&\{\pd{n}, \pd{m}\} = \{\p{n}, \p{m}\} = 0 \ ,
}
and if particles are bosons, $\pd{n}$ and $\p{m}$ satisfy the commutation relations:
\multiline{
&&[\pd{n}, \p{m}] = \pd{n}\p{m} - \p{m}\pd{n} = \delta_{n, m} \ , \nonumber \\
&&[\pd{n}, \pd{m}] = [\p{n}, \p{m}] = 0 \ .
}
In the current study, we are considering collective excitations of atom or molecules in the lattice. They have the 
characteristics of both fermions and bosons. When two excitations reside at different sites, they behave like
bosons, that is,
\oneline{
\pd{n}\p{m} - \p{m}\pd{n} = 0 \label{eqn:boson-like}
}
if $n \neq m$; when excitations are at the same site, they behave like fermions, that is,
\oneline{
\pd{n}\p{m} + \p{m}\pd{n} = 0 \label{eqn:fermion-like}
}
if $n = m$. For convenience, we can combine \autoref{eqn:boson-like} and \autoref{eqn:fermion-like} into one equation:
\oneline{
\p{m}\pd{n} = \delta_{m, n} + (1- 2 \delta_{m, n}) \pd{n}\p{m} \ .  \label{eqn:excitonCommutation}
}

Using the two-particle basis set $\ket{n}\ket{m}$ (and $n \neq m$), \autoref{eqn:equationForG} can be rewritten as
\oneline{
\bra{n} \bra{m} (z - \hat{H}) \hat{G}(z) \ket{n^{\prime} } \ket{m^{\prime} } = \bra{n} \bra{m} \ket{n^{\prime} } \ket{m^{\prime} } \ . \label{eqn:startEqnForG}
}
To simplify the above equation, we make use of \autoref{eqn:excitonCommutation} and evaluate the effect of the 
Hamiltonian operating on the basis set:
\multiline{
\hat{H} \ket{n} \ket{m} &=& (e_{n} + e_{m} ) \ket{n} \ket{m} + \sum_{r \neq 0}(1-\delta_{n-r, m}) t_{n-r, n} \ket{n-r} \ket{m}  \nonumber \\
&& + \sum_{r \neq 0} (1-\delta_{n, m-r}) t_{m-r, m} \ket{n} \ket{m - r} +  \sum_{r \neq 0} d_{n, m} \delta_{n-m, \pm r} \ket{n} \ket{m}  \ ,  \nonumber \\
}
where the factors like $(1-\delta_{n-r, m})$ appear because only the two-particle states $\ket{n}\ket{m}$ with 
$n \neq m$ are included in the basis set, 
then the left hand side of \autoref{eqn:startEqnForG} becomes
\multiline{
&&\bra{n} \bra{m} (z - \hat{H}) \hat{G}(z) \ket{n^{\prime} } \ket{m^{\prime} } \nonumber \\
&&= (z - e_{n} - e_{m} ) G(n, m, n^{\prime}, m^{\prime}; z) 
- \sum_{r \neq 0} (1-\delta_{n-r, m}) t_{n-r, n} G(n-r, m, n^{\prime}, m^{\prime}; z) \nonumber \\
&& - \sum_{r \neq 0}(1-\delta_{n, m-r}) t_{m-r, m} G(n, m-r, n^{\prime}, m^{\prime}; z) 
 -  \sum_{r \neq 0} d_{n, m} \delta_{n-m, \pm r}  G(n, m, n^{\prime}, m^{\prime}; z) \ , \nonumber \\
}
where $G(n, m, n^{\prime}, m^{\prime}; z)$ represents the matrix element of the Green's operator in the two-particle 
basis set and it is given by
\oneline{
G(n, m, n^{\prime}, m^{\prime}; z) =  \bra{n} \bra{m} \hat{G}(z) \ket{n^{\prime} } \ket{m^{\prime} } \ .
}
Similarly, substituting \autoref{eqn:excitonCommutation} into the right hand side of \autoref{eqn:startEqnForG}  gives
rise to 
\oneline{
 \bra{n} \bra{m} \ket{n^{\prime} } \ket{m^{\prime} }= \delta_{m, n^{\prime}}  \delta_{n, m^{\prime}} +  \delta_{n, n^{\prime}}  \delta_{m, m^{\prime}} \ .
}
Therefore, the equation of the motion for the Green's function is given by
\multiline{
&&\left(z - e_{n} - e_{m} -  \sum_{r \neq 0} d_{n, m} \delta_{n-m, \pm r} \right) G(n, m, n^{\prime}, m^{\prime}; z) \nonumber \\
&& - \sum_{r \neq 0} (1-\delta_{n-r, m}) t_{n-r, n} G(n-r, m, n^{\prime}, m^{\prime}; z) \nonumber \\
&& - \sum_{r \neq 0} (1-\delta_{n, m-r})t_{m-r, m} G(n, m-r, n^{\prime}, m^{\prime}; z) \nonumber \\
&& =  \delta_{m, n^{\prime}}  \delta_{n, m^{\prime}} +  \delta_{n, n^{\prime}}  \delta_{m, m^{\prime}} \ . \label{eqn:eqnOfMotion}
}
Because two excitations cannot reside at the same lattice site, we know the Green's function 
$G(n, m, n^{\prime}, m^{\prime}; z)$ is meaningless whenever $n=m$ or $n^{\prime} = m^{\prime}$. It is clear that
\autoref{eqn:eqnOfMotion} can't guarantee all the Green's functions that it contains are physical even if we restrict
the basis set to be just $\ket{i}\ket{j}$ where $i \neq j$. That's why the factors like  $(1-\delta_{n, m-r})$ appear. 

Since all the Green's function in \autoref{eqn:eqnOfMotion} have the same parameters $n^{\prime}$ and
 $m^{\prime}$, we define 
\oneline{
\Tilde{G} (n, m; z) = G(n, m, n^{\prime}, m^{\prime}; z) \ 
}
to simplify the notation. Then \autoref{eqn:eqnOfMotion} can be written as
\multiline{
&&\left(z - e_{n} - e_{m} -  \sum_{r \neq 0} d_{n, m} \delta_{n-m, \pm r} \right) \Tilde{G}(n, m; z) \nonumber \\
&& - \sum_{r \neq 0} (1-\delta_{n-r, m}) t_{n-r, n} \Tilde{G}(n-r, m; z) - \sum_{r \neq 0} (1-\delta_{n, m-r}) t_{m-r, m} \Tilde{G}(n, m-r; z) \nonumber \\
&& =  \delta_{m, n^{\prime}}  \delta_{n, m^{\prime}} +  \delta_{n, n^{\prime}}  \delta_{m, m^{\prime}} \ . \label{eqn:eqnOfMotionSimplified}
}

\section{Recursive calculation of Green's function}
\label{sec:recursiveGreen}

\subsection{In the nearest neighbor approximation}
\label{sec:nna}

The equation of motion of Green's function, \autoref{eqn:eqnOfMotionSimplified}, is our starting point to calculate
the Green's function. In the nearest neighbor approximation, the distance between two interacting sites $r$ can only 
be 1 or $-1$, then the quation of motion of Green's function becomes
\multiline{
&&\left(z - e_{n} - e_{m} -   d_{n, m} \delta_{n-m, \pm 1} \right) \Tilde{G}(n, m; z) \nonumber \\
&& - (1- \delta_{n-1, m}) t_{n-1, n} \Tilde{G}(n-1, m; z) - (1- \delta_{n+1, m}) t_{n+1, n} \Tilde{G}(n+1, m; z) \nonumber \\
&& - (1- \delta_{n, m-1}) t_{m-1, m}\Tilde{G}(n, m-1; z) - (1- \delta_{n, m+1}) t_{m+1, m} \Tilde{G}(n, m+1; z) \nonumber \\
&& =  \delta_{m, n^{\prime}}  \delta_{n, m^{\prime}} +  \delta_{n, n^{\prime}}  \delta_{m, m^{\prime}} \ . \label{eqn:eqnOfMotionNNA}
}
As metioned before, the factors like $(1- \delta_{n-1, m})$ in \autoref{eqn:eqnOfMotionNNA} are used to eliminate 
the unphysical Green's functions like $\Tilde{G}(i, i; z)$. For instance, when $n = m - 1$, $\Tilde{G}(n+1, m; z)$ and 
$\Tilde{G}(n, m-1; z)$ will disappear in \autoref{eqn:eqnOfMotionNNA} because of the factors in front of them. 
\Autoref{eqn:eqnOfMotionNNA} shows that $\Tilde{G}(n, m; z)$ only relates directly with at most four other Green's
functions in the nearest neighbor approximation. This relationship can be shown schematically as follows:
\multiline{
& \vdots & \nonumber \\
\Tilde{G}(n-1, m+1; z) &\rightarrow& \bigg\{  \Tilde{G}(n-2, m+1; z),  \Tilde{G}(n-1, m; z), \Tilde{G}(n, m+1; z),\Tilde{G}(n-1, m+2; z) \bigg\} \nonumber \\
\Tilde{G}(n, m; z) &\rightarrow& \bigg\{  \Tilde{G}(n-1, m; z),  \Tilde{G}(n, m-1; z), \Tilde{G}(n+1, m; z),\Tilde{G}(n, m+1; z) \bigg\} \nonumber \\
\Tilde{G}(n+1, m-1; z) &\rightarrow& \bigg\{  \Tilde{G}(n, m-1; z),  \Tilde{G}(n+1, m-2; z), \Tilde{G}(n+2, m-1; z),\Tilde{G}(n+1, m; z) \bigg\} \nonumber \\
& \vdots &  \nonumber \\
}
For the Green's function $\Tilde{G}(i, j; z)$ on the left, the summation of parameters $i + j = n + m$ is fixed. For the 
Green's functions $\Tilde{G}(i^{\prime}, j^{\prime}; z)$ on the right, the summation of parameters
 $i^{\prime} + j^{\prime}$ can only be either $n+m-1$ or $n+m+1$. 
This inspire us to group some Green's functions into a vector $\mathbf{V}_{K}$ according to their parameters $n$ and $m$, that is,
\oneline{
\mathbf{V}_{K} = \colvec{5}{\cdots}{\Tilde{G}(i-1, j+1; z)}{\Tilde{G}(i, j; z)}{\Tilde{G}(i+1, j-1; z)}{\vdots} \ , \label{eqn:defVk}
} 
then \autoref{eqn:eqnOfMotionNNA} can be written as
\multiline{
\mathbf{V}_{K} = \boldsymbol\alpha_{K}(z) \mathbf{V}_{K-1} +\boldsymbol\beta_{K}(z)\mathbf{V}_{K+1} \label{eqn:VkNotEqual}
}
if $n^{\prime} + m^{\prime} \neq K$, and as
\multiline{
\mathbf{V}_{K} =  \boldsymbol\alpha_{K}(z) \mathbf{V}_{K-1} +\boldsymbol\beta_{K}(z)\mathbf{V}_{K+1}  + \mathbf{C} \label{eqn:VkEqual}
}
if $n^{\prime} + m^{\prime} = K$. In the above two equations, $\boldsymbol\alpha_{K}(z)$ and
 $\boldsymbol\beta_{K}(z)$
are matrices and $\mathbf{C}$ is a constant vector, and their values can be determined from 
\autoref{eqn:eqnOfMotionNNA}. Because the two excitations are indistinguishable from each other, $\Tilde{G}(n, m; z)$ is equivalent 
to $\Tilde{G}(m, n; z)$. In the following discussion, we require $n<m$ in all $\Tilde{G}(n, m; z)$ to reduce the dimension
 of $\mathbf{V}_{K}$ by half.

 Deriving the expression for $\boldsymbol\alpha_{K}(z)$ and
 $\boldsymbol\beta_{K}(z)$ by hand is tedious, we choose to do that in a programmable way. The 
pseudocode is given below:
\begin{algorithmic}[1]
\State Form all the vectors $\mathbf{V}_{K}$ for $K=1$ to $2N-1$
\State Generate the index $\mathbf{I}(n,m)$ of every $\Tilde{G}(n, m; z)$ such that the $\mathbf{I}(n,m)$th element 
of $\mathbf{V}_{n+m}$ is $\Tilde{G}(n, m; z)$, that is $\mathbf{V}_{n+m}[\mathbf{I}(n,m)] = \Tilde{G}(n, m; z)$
\For{every $\Tilde{G}(i, j; z)$ in $\mathbf{V}_{K}$ }
%     \State leftNeighborFirst $\gets$ null
 %    \State leftNeighborSecond $\gets$ null
     \State $n^{\rm th}$ $\gets$ $\mathbf{I}(i,j)$
    % obtain alpha
     \State Set every element of $\boldsymbol\alpha_{K}$ to 0
      \If {$i-1\geq 0$}
                   \State $m^{\rm th}$ $\gets$ $ \mathbf{I}(i-1, j)$  
                   \State $\boldsymbol\alpha_{K}(n^{\rm th}, m^{\rm th})$ $\gets$ $\frac{t_{i-1, i}}{z - e_{i} - e_{j} -   d_{i, j} \delta_{j-i, 1}}$
       \EndIf
%
      \If {$j-1 > i$}
                   \State $m^{\rm th}$ $\gets$ $ \mathbf{I}(i, j-1)$  
                   \State $\boldsymbol\alpha_{K}(n^{\rm th}, m^{\rm th})$ $\gets$ $\frac{t_{j-1, j}}{z - e_{i} - e_{j} -   d_{i, j} \delta_{j-i, 1}}$
       \EndIf
    %obtain beta
        \State Set every element of $\boldsymbol\beta_{K}$ to 0
      \If {$i+1\leq j$}
                   \State $m^{\rm th}$ $\gets$ $ \mathbf{I}(i+1, j)$  
                   \State $\boldsymbol\beta_{K}(n^{\rm th}, m^{\rm th})$ $\gets$ $\frac{t_{i, i+1}}{z - e_{i} - e_{j} -   d_{i, j} \delta_{j-i, 1}}$
       \EndIf
%
      \If {$j+1\leq N$}
                   \State $m^{\rm th}$ $\gets$ $ \mathbf{I}(i, j+1)$  
                   \State $\boldsymbol\beta_{K}(n^{\rm th}, m^{\rm th})$ $\gets$ $\frac{t_{j, j+1}}{z - e_{i} - e_{j} -   d_{i, j} \delta_{j-i, 1}}$
       \EndIf
\EndFor
\end{algorithmic}
As we will show in the next subsection, the above algorithm is even more useful when the coupling equations like
\autoref{eqn:eqnOfMotionNNA} get more complicated in the cases of
 longer range interaction and high-dimensional systems.

 It is clear from 
\autoref{eqn:VkNotEqual} and \autoref{eqn:VkEqual} that $\mathbf{V}_{K}$ relates only with  $\mathbf{V}_{K-1}$ and 
 $\mathbf{V}_{K+1}$. This gives the opportunity to solve for individual $\mathbf{V}_{K}$ recursively provided that 
a starting point is given. For example, given the values for two particular $\mathbf{V}_{K}$ and 
$\mathbf{V_{K-1}}$, we can obtain $\mathbf{V}_{K+1}$, and then calculate $\mathbf{V}_{K+2}$ from $\mathbf{V}_{K}$ 
and $\mathbf{V}_{K+1}$, and etc.  
But where do we start? The hint comes from the following physical arguments: $G(n+\delta n, m+\delta m, n, m; z)$ is 
expected to approach zero as $|\delta n| \rightarrow \infty$ and $|\delta m| \rightarrow \infty$ because its Fourier
transform $G(n+\delta n, m+\delta m, n, m; t)$ represents the amplitude for the two particles to move a distance
 $\delta n$ and  $\delta m$ respectively in time $t$ \cite{economou2006, Berciu2010}. To figures out which Green's 
functions can be approximated by zero, we fix  the values of $n^{\prime}$ and $m^{\prime}$. Suppose
 $K_c = n^{\prime} + m^{\prime}$, then we can assume $\mathbf{V}_{K}$ approaches zero when 
$|K - K_c | \rightarrow \infty$. For the purpose of numerical computation, a cutoff distance $M$ is chosen such that
$\mathbf{V}_{K_c - M}$ and $\mathbf{V}_{K_c + M}$ are very small. In this case, the infinite crystal is 
replaced by a finite crystal whose centeral region contains site $n^{\prime}$ and site $m^{\prime}$. To ensure the
convergence of the results, the finite crystal must be large enough such that its boundaries are  far away
from both site $n$ and site $m$. Assuming the 1D finite crystal has $N+1$ lattice sites indexed by $0, 1, \cdots, 
N-1, N$, the starting point for the recursive calculation of the Green's function are the following two 
approximations:
\multiline{
\mathbf{V}_{2N-1} &\approx& 0 \ , \nonumber \\
\mathbf{V}_{1} &\approx& 0 \ . \label{eqn:startPoint}
}

Given the two approximations in \autoref{eqn:startPoint}, we are ready to calculate the Green's functions
 recursively. Instead of working with the vectors $\mathbf{V}_{K}$ directly, we define two quantities 
$\mathbf{A}_{K}$ and $\mathbf{\Tilde{A}}_{K} $ that relates
two consecutive vectors $\mathbf{V}_{K}$ and $\mathbf{V}_{K-1}$. For $n \ge K_c + 1$, we have
\multiline{
\mathbf{V}_{n+1} = \mathbf{A}_{n+1} \mathbf{V}_{n} \ , \label{eqn:definitionForA}
}
and for $n \le K_c - 1$, we have
\multiline{
\mathbf{V}_{n} = \mathbf{\Tilde{A}}_{n} \mathbf{V}_{n+1} \ .  \label{eqn:definitionForTildeA}
}
The validity of the above two equations can be verified by substituting \autoref{eqn:startPoint} into
 \autoref{eqn:VkNotEqual} and solving $\mathbf{V}_{K}$ recursively. Because $\mathbf{V}_{K_c}$ satisfies 
\autoref{eqn:VkEqual} rather than \autoref{eqn:VkNotEqual}, \autoref{eqn:definitionForA} and 
\autoref{eqn:definitionForTildeA} are not valid for $n = K_c$. At the left boundary of the crystal for which $n=1$, we have
\multiline{
\mathbf{V}_{1} = \boldsymbol\beta_{1}(z)\mathbf{V}_{2} \label{eqn:V1}
}
because of \autoref{eqn:VkNotEqual}, and compare it with \autoref{eqn:definitionForTildeA}, we conclude 
\oneline{
\mathbf{\Tilde{A}}_{1} =  \boldsymbol\beta_{1}(z) \ . \label{eqn:TildeA1}
}
There is a recursive relation between different $\mathbf{\Tilde{A}}_{n}$. Substituting 
$\mathbf{V}_{n-1} = \mathbf{\Tilde{A}}_{n-1} \mathbf{V}_{n} $ into \autoref{eqn:VkNotEqual}, we obtain
\multiline{
\mathbf{V}_{n} = \left[ 1- \boldsymbol\alpha_{n}(z) \mathbf{\Tilde{A}}_{n-1}\right]^{-1}\boldsymbol\beta_{n}(z) \mathbf{V}_{n+1} \ ,
}
which upon comparsion with \autoref{eqn:definitionForTildeA} gives rise to
\multiline{
\mathbf{\Tilde{A}}_{n} = \left[ 1- \boldsymbol\alpha_{n}(z) \mathbf{\Tilde{A}}_{n-1}\right]^{-1}\boldsymbol\beta_{n}(z)  \ . \label{eqn:recursionForTildeA}
}
Since \autoref{eqn:recursionForTildeA} involves matrix inversion which is difficult to compute numerically, we may calculate
$\mathbf{\Tilde{A}}_{n}$ by solving the linear equation
\oneline{
 \left[ 1- \boldsymbol\alpha_{n}(z) \mathbf{\Tilde{A}}_{n-1}\right] \mathbf{\Tilde{A}}_{n} = \boldsymbol\beta_{n}(z) \ .
}
Similarly at the right boundary of the crystal for which $n=2N-1$, we obtain the starting value of $\mathbf{A}_{K}$
\oneline{
\mathbf{A}_{2N-1} =  \boldsymbol\alpha_{2N-1}(z) \ , \label{eqn:ARightEnd}
}
and the recursive relation
\oneline{
\mathbf{A}_{n} = \left[ 1 - \boldsymbol\beta_{n}(z) \mathbf{A}_{n+1}\right]^{-1} \boldsymbol\alpha_{n}(z) \ . \label{eqn:recursionForA}
}
To calculate the Green's functions, we  
start from the left boundary of the crystal and calculate $\mathbf{\Tilde{A}}_{1}$, 
$\mathbf{\Tilde{A}}_{2}$, $\cdots$, from left to
center until $\mathbf{\Tilde{A}}_{K_c - 1}$ is reached. We have to stop there because  
\autoref{eqn:definitionForTildeA} is not valid for  $\mathbf{V}_{K_c}$. 
Then we proceed from the right boundary to the center and calculate $\mathbf{A}_{2N-1}$, 
$\mathbf{A}_{2N-2}$, $\cdots$ and stop until we reach $\mathbf{A}_{K_c + 1}$ beyond which
\autoref{eqn:definitionForA} is not valid. Knowning the value of $\mathbf{A}_{K_c + 1}$ and 
$\mathbf{\Tilde{A}}_{K_c - 1}$, we rewrite $\mathbf{V}_{K_c +1}$ and $\mathbf{V}_{K_c - 1}$ in terms of
 $\mathbf{V}_{K_c}$:
\multiline{
\mathbf{V}_{K_c+1} &=& \mathbf{A}_{K_c +1} \mathbf{V}_{K_c} \ , \nonumber \\
\mathbf{V}_{K_c - 1} &=& \mathbf{\Tilde{A}}_{K_c -1} \mathbf{V}_{K_c} \ ,
}
and substitute them into \autoref{eqn:VkEqual} to obtain the solution for $\mathbf{V}_{K_c}$:
\multiline{
\mathbf{V}_{K_c} =  \left[ 1 - \boldsymbol\alpha_{K_c}(z)  \mathbf{\Tilde{A}}_{K_c -1}  - \boldsymbol\beta_{K_c}(z) \mathbf{A}_{K_c +1} \right]^{-1} \mathbf{C} \ . \label{eqn:solForKc}
}
Once $\mathbf{V}_{K_c}$ is known, all $\mathbf{V}_{n}$ can be calculated from \autoref{eqn:definitionForA} and
\autoref{eqn:definitionForTildeA} given the values for $\mathbf{A}_{n+1}$ and $\mathbf{\Tilde{A}}_{n}$.

In summary, the aforementioned calculation of Green's function is carried on in the following steps: 
\begin{enumerate}
%%
\item{fix the value of $n^{\prime}$ and $m^{\prime}$ in the Green's function $G(n, m, n^{\prime}, m^{\prime}; z)$, 
assume the two approximations in \autoref{eqn:startPoint}, and calculate $\mathbf{\Tilde{A}}_{1}$ from 
\autoref{eqn:TildeA1} and $\mathbf{A}_{2N-1}$ from \autoref{eqn:ARightEnd} }
%%
\item{start from $\mathbf{\Tilde{A}}_{1}$ and calculate $\mathbf{\Tilde{A}}_{2}$, $\mathbf{\Tilde{A}}_{3}$, $\cdots$, 
$\mathbf{\Tilde{A}}_{K_c - 1}$ from \autoref{eqn:recursionForTildeA} }
%%
\item{start from $\mathbf{A}_{2N-1}$ and calculate $\mathbf{A}_{2N-1}$, 
$\mathbf{A}_{2N-2}$, $\cdots$, $\mathbf{A}_{K_c + 1}$ from \autoref{eqn:recursionForA} }
%%
\item{use the values of $\mathbf{\Tilde{A}}_{K_c - 1}$ and $\mathbf{A}_{K_c + 1}$ to calculate $\mathbf{V}_{K_c}$ 
from \autoref{eqn:solForKc} }
%%
\item{start from $\mathbf{V}_{K_c}$ and calculate $\mathbf{V}_{K_c-1}$, $\mathbf{V}_{K_c-2}$, $\cdots$, 
$\mathbf{V}_{1}$ from \autoref{eqn:definitionForTildeA} }
%%
\item{start from $\mathbf{V}_{K_c}$ and calculate $\mathbf{V}_{K_c+1}$, $\mathbf{V}_{K_c+2}$, $\cdots$, $\mathbf{V}_{2N-1}$ from \autoref{eqn:definitionForA} }
%%
\end{enumerate}

\subsection{Extension to long-range interaction}
\label{sec:long-range}

As mentioned in \autoref{sec:long-rangeInteraction}, dipole-dipole interaction is long-ranged and the nearest 
neighbor approximation may not represent the physical picture accurately. So it is desirable to extend the 
calculation method of Green's function in \autoref{sec:nna} to the case of long-range interaction. 

First, we consider a 1D lattice with the same Hamiltonian (see \autoref{eqn:initialHam}) that has
both first nearest-neighbor and second nearest-neighbor interactions. 
%In this case, the distance $r$ between two 
%sites can be $-2$, $-1$, $1$, and $2$. In \autoref{sec:nna}, we consider the case of both positive and negative value
%of $r$. In fact, since excitations at different sites are indistinguishable, $\ket{n}\ket{m}$ is equivalent to 
%$\ket{m}\ket{n}$. Therefore, we can limit the two-particle basis to $\ket{n}\ket{m}$ where $n<m$ and then consider
%only the positive $r$ values.  
Then the equation of motion for the Green's
function becomes
\multiline{
&&\left(z - e_{n} - e_{m} -   d_{n, m} \delta_{m-n, \pm 1} - d_{n, m} \delta_{m-n, \pm 2}\right) \Tilde{G}(n, m; z) \nonumber \\
&& - (1- \delta_{n-1, m}) t_{n-1, n} \Tilde{G}(n-1, m; z) - (1- \delta_{n+1, m}) t_{n+1, n} \Tilde{G}(n+1, m; z) \nonumber \\
&& - (1- \delta_{n, m-1}) t_{m-1, m}\Tilde{G}(n, m-1; z) - (1- \delta_{n, m+1}) t_{m+1, m} \Tilde{G}(n, m+1; z) \nonumber \\
&& - (1- \delta_{n-2, m}) t_{n-2, n} \Tilde{G}(n-1, m; z) - (1- \delta_{n+2, m}) t_{n+2, n} \Tilde{G}(n+2, m; z) \nonumber \\
&& - (1- \delta_{n, m-2}) t_{m-2, m}\Tilde{G}(n, m-2; z) - (1- \delta_{n, m+2}) t_{m+2, m} \Tilde{G}(n, m+2; z) \nonumber \\
&& =  \delta_{m, n^{\prime}}  \delta_{n, m^{\prime}} +  \delta_{n, n^{\prime}}  \delta_{m, m^{\prime}} \ .  \label{eqn:eqnOfMotionNNN}
}
The above equation shows that the
Green's functions $\Tilde{G}(n^{\prime}, m^{\prime}; z)$ are only coupled with the Green's function 
$\Tilde{G}(i, j; z)$ whose parameters $i$ and $ j$ sum up to $n+m-1$ or $n+m+1$ or $n+m-2$ or $n+m+2$. As in the
case of nearest neighbor approximation, we can group the Green's functions according to the summation of their 
parameters and obtain:
\multiline{
\mathbf{Z}_{K} \mathbf{V}_{K} = \mathbf{M}_{K, K+1}\mathbf{V}_{K+1} +  \mathbf{M}_{K,K -1}\mathbf{V}_{K-1} +  \mathbf{M}_{K, K+2}\mathbf{V}_{K+2} +  \mathbf{M}_{K, K-2}\mathbf{V}_{K-2} \ , \label{eqn:VkNNN}
}
where $\mathbf{V}_{K}$ has the same definition as in \autoref{eqn:defVk}. Different from the NNA case where 
the recurrence relation links three consecutive terms $\mathbf{V}_{K}$, $\mathbf{V}_{K-1}$ and 
 $\mathbf{V}_{K+1}$, \autoref{eqn:VkNNN} has two extra terms $\mathbf{V}_{K-2}$ and 
 $\mathbf{V}_{K+2}$.  At first glance, adding the second nearest-neighbor interactions invalidates the method presented in \autoref{sec:nna} as the calculation of Green's 
function relies on a recurrence relation linking three consecutive terms. But if we work with combinations of 
$\mathbf{V}_K$ instead of individual $\mathbf{V}_K$, we can obtain the proper recurrence relation. Replacing $K$
with $K+1$ in \autoref{eqn:VkNNN}, we obtain
\multiline{
\mathbf{Z}_{K+1} \mathbf{V}_{K+1} = \mathbf{M}_{K+1, K+2}\mathbf{V}_{K+2} +  \mathbf{M}_{K+1,K}\mathbf{V}_{K} +  \mathbf{M}_{K+1, K+3}\mathbf{V}_{K+3} +  \mathbf{M}_{K+1, K-1}\mathbf{V}_{K-1} \ .  \nonumber  \\
\label{eqn:VkPlusNNN}
}
\Autoref{eqn:VkNNN} and \autoref{eqn:VkPlusNNN} can be written in the following form:
\oneline{
\mathbf{W}_{2K+1}\colvec{2}{\mathbf{V}_{K}}{\mathbf{V}_{K+1}} = \boldsymbol\alpha_{2K-3} \colvec{2}{\mathbf{V}_{K-2}}{\mathbf{V}_{K-1}} + \boldsymbol\beta_{2K+5} \colvec{2}{\mathbf{V}_{K+2}}{\mathbf{V}_{K+3}}
 \label{eqn:blockEqnNNN}
}
where
\oneline{
\mathbf{W}_{2K+1} = \mat{\mathbf{Z}_{K} & -\mathbf{M}_{K,K+1} \\ -\mathbf{M}_{K+1,K} & \mathbf{Z}_{K+1} } \ ,
}
\oneline{
\boldsymbol\alpha_{2K-3} = \mat{\mathbf{M}_{K, K-2} & -\mathbf{M}_{K, K-1} \\ \mathbf{0} & \mathbf{Z}_{K+1, K-1} } \ ,
}
\oneline{
\boldsymbol\beta_{2K+5} = \mat{\mathbf{M}_{K, K+2} &  \mathbf{0} \\  \mathbf{M}_{K+1, K-+2} & \mathbf{Z}_{K+1, K+3} } \ .
}
Comparing \autoref{eqn:blockEqnNNN} with \autoref{eqn:VkNotEqual}, we can see that the method introduced
in \autoref{sec:nna} will also work for the current case if we define
\oneline{
\mathbf{\Tilde{V}}_{2K+1} \equiv \colvec{2}{\mathbf{V}_{K}}{\mathbf{V}_{K+1}} 
}
and use the series of vectors $\mathbf{\Tilde{V}}_{1}$, $\mathbf{\Tilde{V}}_{5}$, $\mathbf{\Tilde{V}}_{9}$,
 $\cdots$ rather than $\mathbf{V}_{1}$, $\mathbf{V}_{2}$, $\mathbf{V}_{3}$, $\cdots$.

To further illustrate the point, we consider an even longer range interaction with the first nearest-neighbor, second 
nearest-neighbor, and the third nearest-neighbor couplings. Similarly, we work with a set of equations that relate 
different $\mathbf{V}_K$:
\multiline{
\mathbf{Z}_{K} \mathbf{V}_{K} &=&\mathbf{M}_{K, K+1}\mathbf{V}_{K+1} +  \mathbf{M}_{K,K -1}\mathbf{V}_{K-1} +  \mathbf{M}_{K, K+2}\mathbf{V}_{K+2} +  \mathbf{M}_{K, K-2}\mathbf{V}_{K-2}  \nonumber \\
&& +  \mathbf{M}_{K, K+3}\mathbf{V}_{K+3} +  \mathbf{M}_{K, K-3}\mathbf{V}_{K-3} \ ,
}
\multiline{
\mathbf{Z}_{K+1} \mathbf{V}_{K+1} &=&\mathbf{M}_{K+1, K+2}\mathbf{V}_{K+2} +  \mathbf{M}_{K+1, K}\mathbf{V}_{K} +  \mathbf{M}_{K+1, K+3}\mathbf{V}_{K+3} +  \mathbf{M}_{K+1, K-1}\mathbf{V}_{K-1}  \nonumber \\
&& +  \mathbf{M}_{K+1, K+4}\mathbf{V}_{K+4} +  \mathbf{M}_{K+1, K-2}\mathbf{V}_{K-2} \ ,
}
\multiline{
\mathbf{Z}_{K+2} \mathbf{V}_{K+2} &=&\mathbf{M}_{K+2, K+3}\mathbf{V}_{K+3} +  \mathbf{M}_{K+2, K+1}\mathbf{V}_{K+1} +  \mathbf{M}_{K+2, K+4}\mathbf{V}_{K+4} +  \mathbf{M}_{K+2, K}\mathbf{V}_{K}  \nonumber \\
&& +  \mathbf{M}_{K+2, K+5}\mathbf{V}_{K+5} +  \mathbf{M}_{K+2, K-1}\mathbf{V}_{K-1} \ .
}
These equations give rise to a recurence relation that link three vectors:
\multiline{
&&\mat{\mathbf{Z}_{K} & -\mathbf{M}_{K,K+1} &  -\mathbf{M}_{K,K+2}\\ -\mathbf{M}_{K+1,K} & \mathbf{Z}_{K+1}& 
 -\mathbf{M}_{K+1,K+2} \\ -\mathbf{M}_{K+2,K} & 
 -\mathbf{M}_{K+2,K+1}&  \mathbf{Z}_{K+2} }\colvec{3}{\mathbf{V}_{K}}{\mathbf{V}_{K+1}}{\mathbf{V}_{K+2}} \nonumber \\
\nonumber \\
%
&&=\mat{\mathbf{M}_{K,K-3} & \mathbf{M}_{K,K-2} &  \mathbf{M}_{K,K-1}\\ \mathbf{0} & \mathbf{M}_{K+1,K-2}& 
 \mathbf{M}_{K+1,K-1} \\ \mathbf{0} & 
 \mathbf{0}&  \mathbf{M}_{K+2,K-1} }\colvec{3}{\mathbf{V}_{K-3}}{\mathbf{V}_{K-2}}{\mathbf{V}_{K-1}} 
\nonumber \\
\nonumber \\
%
&&+ \mat{ 
 \mathbf{M}_{K, K+3}& \mathbf{0} & \mathbf{0}&  \\ 
\mathbf{M}_{K+1,K+3}&  \mathbf{M}_{K+1,K+4}& \mathbf{0}   \\ 
\mathbf{M}_{K+2, K+3} & \mathbf{M}_{K+2, K+4} &  \mathbf{M}_{K+2, K+5}
}
\colvec{3}{\mathbf{V}_{K+3}}{\mathbf{V}_{K+4}}{\mathbf{V}_{K+5}} 
}


\section{The tunneling of biexciton state through disorders}
\label{sec:biexcitonTunneling}

In this section, we use the Green's function to study the tunneling of a biexciton state through disorders. 


\section{Conclusion}
\label{sec:conclusionGreenFunc}
